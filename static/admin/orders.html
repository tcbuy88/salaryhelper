<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>è®¢å•ç®¡ç† - SalaryHelper Admin</title>
  <link rel="stylesheet" href="../styles.css"/>
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <div class="app-header-content">
        <a href="index.html" class="app-logo">âš–ï¸ SalaryHelper Admin</a>
        <div class="user-info">
          <span class="badge badge-warning">ç®¡ç†å‘˜</span>
          <a href="index.html" class="btn btn-sm btn-ghost">è¿”å›åå°é¦–é¡µ</a>
        </div>
      </div>
    </header>

    <div class="main-content">
      <div class="container-wide">
        <div class="flex justify-between items-center mb-lg">
          <div>
            <h2 class="mb-0">è®¢å•ç®¡ç†</h2>
            <p class="text-secondary mt-sm">æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰è®¢å•</p>
          </div>
          <button id="refreshBtn" class="btn btn-primary">ğŸ”„ åˆ·æ–°</button>
        </div>

        <div class="card">
          <div id="orderTableContainer"></div>
        </div>
      </div>
    </div>
  </div>
  
  <script src="../api-client-real.js"></script>
  <script>
    async function loadOrders() {
      const container = document.getElementById('orderTableContainer');
      try {
        container.innerHTML = '<div class="loading"><div class="loading-spinner"></div><div>åŠ è½½ä¸­...</div></div>';
        const orders = await ApiClient.adminListOrders();
        
        if (orders.length === 0) {
          container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ğŸ’°</div><div class="empty-state-title">æš‚æ— è®¢å•</div></div>';
          return;
        }
        
        container.innerHTML = `
          <div class="table-container">
            <table class="table">
              <thead>
                <tr>
                  <th>è®¢å•ID</th>
                  <th>ç”¨æˆ·</th>
                  <th>äº§å“ç±»å‹</th>
                  <th>é‡‘é¢</th>
                  <th>æ”¯ä»˜æ–¹å¼</th>
                  <th>çŠ¶æ€</th>
                  <th>åˆ›å»ºæ—¶é—´</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody>
                ${orders.map(order => `
                  <tr>
                    <td>${order.id.substring(0, 8)}...</td>
                    <td>${order.phone || order.user_name || '-'}</td>
                    <td>${order.product_type || '-'}</td>
                    <td>Â¥${order.amount.toFixed(2)}</td>
                    <td>${order.payment_method || '-'}</td>
                    <td>
                      <span class="badge ${order.status === 'paid' ? 'badge-success' : order.status === 'pending' ? 'badge-warning' : 'badge-secondary'}">
                        ${order.status === 'paid' ? 'å·²æ”¯ä»˜' : order.status === 'pending' ? 'å¾…æ”¯ä»˜' : order.status}
                      </span>
                    </td>
                    <td>${new Date(order.created_at).toLocaleString('zh-CN')}</td>
                    <td>
                      <div class="table-actions">
                        <button class="btn btn-sm btn-outline" onclick="alert('æŸ¥çœ‹è®¢å•è¯¦æƒ…')">æŸ¥çœ‹</button>
                      </div>
                    </td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          </div>
        `;
      } catch (error) {
        container.innerHTML = `<div class="alert alert-error"><span>âš ï¸</span><div>åŠ è½½å¤±è´¥: ${error.message}</div></div>`;
      }
    }
    
    document.getElementById('refreshBtn').addEventListener('click', loadOrders);
    loadOrders();
  </script>
</body>
</html>
